<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Debugging flashQ: Logs, Metrics, and Troubleshooting Guide - flashQ Blog</title>
  <meta name="description" content="Complete troubleshooting guide for flashQ job queues. Learn to diagnose stuck jobs, memory issues, connection problems, and performance bottlenecks with logs and metrics.">
  <meta name="keywords" content="flashq debugging, job queue troubleshooting, queue problems, stuck jobs, dlq debugging, flashq logs, job queue monitoring">
  <meta name="robots" content="index, follow">

  <meta property="og:title" content="Debugging flashQ: Logs, Metrics, and Troubleshooting Guide">
  <meta property="og:description" content="Complete troubleshooting guide for flashQ. Diagnose stuck jobs, memory issues, and performance bottlenecks.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://flashq.dev/blog/debugging-queue-problems.html">
  <meta property="og:image" content="https://flashq.dev/og-image.png">
  <meta property="article:published_time" content="2026-01-19">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Debugging flashQ: Complete Troubleshooting Guide">
  <meta name="twitter:description" content="Diagnose stuck jobs, memory issues, and performance bottlenecks.">
  <meta name="twitter:image" content="https://flashq.dev/og-image.png">

  <link rel="canonical" href="https://flashq.dev/blog/debugging-queue-problems.html">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ö°</text></svg>">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Article",
    "headline": "Debugging flashQ: Logs, Metrics, and Troubleshooting Guide",
    "description": "Complete troubleshooting guide for flashQ job queues with common problems and solutions.",
    "datePublished": "2026-01-19",
    "author": { "@type": "Organization", "name": "flashQ" },
    "publisher": { "@type": "Organization", "name": "flashQ", "url": "https://flashq.dev" }
  }
  </script>

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://flashq.dev" },
      { "@type": "ListItem", "position": 2, "name": "Blog", "item": "https://flashq.dev/blog/" },
      { "@type": "ListItem", "position": 3, "name": "Debugging Queue Problems", "item": "https://flashq.dev/blog/debugging-queue-problems.html" }
    ]
  }
  </script>
  <!-- Highlight.js -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/typescript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
</head>
<body>
  <nav>
    <div class="container wide">
      <a href="../" class="logo"><span>‚ö°</span> flashQ</a>
      <div class="nav-links">
        <a href="../#features">Features</a>
        <a href="../blog/" class="active">Blog</a>
        <a href="../docs/">Docs</a>
        <a href="https://github.com/egeominotti/flashq" target="_blank">GitHub</a>
        <a href="../docs/#quickstart" class="btn btn-primary">Get Started</a>
      </div>
      <button class="mobile-menu-btn" aria-label="Menu"><span></span><span></span><span></span></button>
    </div>
  </nav>

  <div class="mobile-menu">
    <a href="../#features">Features</a>
    <a href="../blog/">Blog</a>
    <a href="../docs/">Docs</a>
    <a href="https://github.com/egeominotti/flashq" target="_blank">GitHub</a>
    <a href="../docs/#quickstart" class="btn btn-primary">Get Started</a>
  </div>

  <header class="article-header header-devops">
    <div class="container">
      <span class="article-tag">Troubleshooting</span>
      <h1>Debugging flashQ: Logs, Metrics, and Troubleshooting Guide</h1>
      <div class="article-meta">
        <span>üìÖ January 19, 2026</span>
        <span>‚è±Ô∏è 12 min read</span>
      </div>
    </div>
  </header>

  <article class="article-content">
    <div class="container">
      <p>Something's wrong with your queue? This guide covers the most common problems and how to diagnose them using logs, metrics, and built-in tools.</p>

      <h2>Diagnostic Tools Overview</h2>

      <h3>1. HTTP API Endpoints</h3>
      <p>The HTTP API provides essential debugging endpoints:</p>

      <pre><code class="language-bash"># Health check - basic server status
curl http://localhost:6790/health

# Detailed statistics
curl http://localhost:6790/stats

# Prometheus metrics
curl http://localhost:6790/metrics/prometheus

# List all queues
curl http://localhost:6790/queues

# Get specific queue info
curl http://localhost:6790/queue/my-queue/stats</code></pre>

      <h3>2. SDK Debugging Methods</h3>
      <pre><code class="language-typescript">import { FlashQ } from 'flashq';

const client = new FlashQ({ host: 'localhost', port: 6789 });

// Get server-wide statistics
const stats = await client.stats();
console.log('Server Stats:', JSON.stringify(stats, null, 2));

// Get metrics with history
const metrics = await client.metrics();
console.log('Metrics:', metrics);

// Get job counts by state
const counts = await client.getJobCounts('my-queue');
console.log('Job Counts:', counts);
// { waiting: 150, active: 10, completed: 5000, failed: 23, delayed: 50 }

// List jobs in a specific state
const failedJobs = await client.getJobs('my-queue', 'failed', 100);
failedJobs.forEach(job => {
  console.log(`Job ${job.id}: ${job.error}`);
});

// Get a specific job's details
const job = await client.getJob(jobId);
console.log('Job State:', job.state);
console.log('Job Data:', job.data);
console.log('Job Attempts:', job.attempts);</code></pre>

      <h3>3. Useful Debugging Script</h3>
      <pre><code class="language-typescript">// debug-queue.ts - Save this for quick diagnostics
import { FlashQ } from 'flashq';

async function diagnose(queueName) {
  const client = new FlashQ({ host: 'localhost', port: 6789 });
  await client.connect();

  console.log('\n=== Queue Diagnostics ===\n');

  // 1. Job counts
  const counts = await client.getJobCounts(queueName);
  console.log('üìä Job Counts:');
  console.log(`   Waiting:   ${counts.waiting}`);
  console.log(`   Active:    ${counts.active}`);
  console.log(`   Completed: ${counts.completed}`);
  console.log(`   Failed:    ${counts.failed}`);

  // 2. Check for stuck jobs
  const activeJobs = await client.getJobs(queueName, 'active', 10);
  console.log('\n‚è≥ Active Jobs:');
  activeJobs.forEach(job => {
    const age = Date.now() - job.processedAt;
    const status = age > 60000 ? '‚ö†Ô∏è POSSIBLY STUCK' : '‚úÖ OK';
    console.log(`   Job ${job.id}: ${Math.round(age/1000)}s old ${status}`);
  });

  // 3. DLQ check
  const dlq = await client.getDlq(queueName, 5);
  console.log(`\n‚ò†Ô∏è Dead Letter Queue: ${dlq.length} jobs`);

  await client.close();
}

diagnose(process.argv[2] || 'default');</code></pre>

      <h2>Problem: Jobs Stuck in Processing</h2>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Jobs show as "active" but never complete</li>
        <li><code>getJobCounts</code> shows high <code>active</code> count that doesn't decrease</li>
        <li>Workers appear idle but jobs aren't being processed</li>
      </ul>

      <h3>Diagnosis Steps</h3>

      <pre><code class="language-typescript">// 1. Check how long jobs have been active
const activeJobs = await client.getJobs('my-queue', 'active', 100);

activeJobs.forEach(job => {
  const activeTime = Date.now() - job.processedAt;
  if (activeTime > 60000) { // More than 1 minute
    console.log(`‚ö†Ô∏è Job ${job.id} stuck for ${Math.round(activeTime/1000)}s`);
    console.log(`   Worker: ${job.workerId}`);
  }
});</code></pre>

      <h3>Common Causes & Solutions</h3>

      <h4>1. Worker Crashed Without ACK</h4>
      <pre><code class="language-typescript">// Problem: Worker died before acknowledging
// Solution: flashQ auto-recovers after stall_timeout

// Set appropriate stall timeout when pushing jobs
await client.push('my-queue', data, {
  stall_timeout: 30000,  // 30 seconds
  timeout: 60000         // 60 second processing timeout
});

// Jobs will automatically return to queue after timeout</code></pre>

      <h4>2. Infinite Loop in Processor</h4>
      <pre><code class="language-typescript">// Problem: Processor never returns
// BAD
const worker = new Worker('my-queue', async (job) => {
  while (true) {  // Infinite loop!
    await doSomething();
  }
});

// GOOD - Always have exit conditions
const worker = new Worker('my-queue', async (job) => {
  const maxIterations = 1000;
  for (let i = 0; i < maxIterations; i++) {
    const done = await doSomething();
    if (done) break;
  }
});</code></pre>

      <h4>3. Manual Recovery</h4>
      <pre><code class="language-typescript">// Force-fail stuck jobs to return them to queue
const activeJobs = await client.getJobs('my-queue', 'active', 100);

for (const job of activeJobs) {
  const activeTime = Date.now() - job.processedAt;
  if (activeTime > 300000) { // Stuck for 5+ minutes
    console.log(`Force-failing stuck job ${job.id}`);
    await client.fail(job.id, 'Manual recovery: job was stuck');
  }
}</code></pre>

      <h2>Problem: DLQ Filling Up</h2>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Many jobs in Dead Letter Queue</li>
        <li>Same errors repeating</li>
        <li>Jobs failing after max retries</li>
      </ul>

      <h3>Diagnosis</h3>

      <pre><code class="language-typescript">// Analyze DLQ errors
const dlqJobs = await client.getDlq('my-queue', 100);

// Group by error type
const errorGroups = {};
dlqJobs.forEach(job => {
  const errorType = job.error?.split(':')[0] || 'Unknown';
  errorGroups[errorType] = (errorGroups[errorType] || 0) + 1;
});

console.log('Error Distribution:');
Object.entries(errorGroups)
  .sort((a, b) => b[1] - a[1])
  .forEach(([error, count]) => {
    console.log(`  ${count}x ${error}`);
  });</code></pre>

      <h3>Common Causes & Solutions</h3>

      <h4>1. External API Failures</h4>
      <pre><code class="language-typescript">// Problem: Third-party API returns errors
// Solution: Add circuit breaker and better retry logic

import CircuitBreaker from 'opossum';

const breaker = new CircuitBreaker(callExternalAPI, {
  timeout: 10000,
  errorThresholdPercentage: 50,
  resetTimeout: 30000
});

const worker = new Worker('api-calls', async (job) => {
  try {
    return await breaker.fire(job.data);
  } catch (error) {
    if (breaker.opened) {
      throw new Error('Circuit breaker open, will retry');
    }
    throw error;
  }
});</code></pre>

      <h4>2. Invalid Job Data</h4>
      <pre><code class="language-typescript">// Problem: Jobs have bad data that will never succeed
// Solution: Validate before processing, discard invalid

const worker = new Worker('process', async (job) => {
  // Validate first
  if (!job.data.userId || !job.data.action) {
    // Don't retry invalid jobs - discard them
    await client.discard(job.id);
    console.log(`Discarded invalid job ${job.id}`);
    return;
  }

  await processJob(job.data);
});</code></pre>

      <h4>3. Retry DLQ Jobs After Fix</h4>
      <pre><code class="language-typescript">// After fixing the root cause, retry DLQ jobs
const retried = await client.retryDlq('my-queue');
console.log(`Retried ${retried} jobs from DLQ`);

// Or retry specific jobs
const dlqJobs = await client.getDlq('my-queue', 100);
for (const job of dlqJobs) {
  if (job.error?.includes('API rate limit')) {
    await client.retryDlq('my-queue', job.id);
  }
}</code></pre>

      <h2>Problem: Slow Processing</h2>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Queue backlog growing</li>
        <li>High latency between push and processing</li>
        <li>Throughput lower than expected</li>
      </ul>

      <h3>Diagnosis</h3>

      <pre><code class="language-typescript">// Check queue depth and processing rate
const stats = await client.stats();
console.log('Queue depths:', stats.queues);

// Monitor throughput over time
const metrics = await client.metrics();
console.log('Throughput history:', metrics.throughput);</code></pre>

      <h3>Common Causes & Solutions</h3>

      <h4>1. Low Worker Concurrency</h4>
      <pre><code class="language-typescript">// Problem: Only processing one job at a time
// Solution: Increase concurrency

// Before
const worker = new Worker('my-queue', processor);  // Default: 1

// After - for I/O bound tasks
const worker = new Worker('my-queue', processor, {
  concurrency: 20  // Process 20 jobs concurrently
});</code></pre>

      <h4>2. Rate Limiting Too Strict</h4>
      <pre><code class="language-typescript">// Increase rate limit
await client.setRateLimit('my-queue', {
  max: 100,      // 100 jobs
  window: 1000   // per second
});

// Or clear rate limit entirely for testing
await client.clearRateLimit('my-queue');</code></pre>

      <h4>3. Enable Binary Protocol</h4>
      <pre><code class="language-typescript">// 40% faster serialization with MessagePack
const client = new FlashQ({
  host: 'localhost',
  port: 6789,
  useBinary: true
});</code></pre>

      <h2>Problem: Connection Issues</h2>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Connection timeouts</li>
        <li>"Connection refused" errors</li>
        <li>Intermittent disconnects</li>
      </ul>

      <h3>Diagnosis</h3>

      <pre><code class="language-bash"># Check if server is running
curl http://localhost:6790/health

# Check port is open
nc -zv localhost 6789

# Check server logs
docker logs flashq-server 2>&1 | tail -100</code></pre>

      <h3>Common Causes & Solutions</h3>

      <h4>1. Connection Pool Exhausted</h4>
      <pre><code class="language-typescript">// Problem: Too many connections
// Solution: Reuse client instances

// BAD - Creates new connection per request
app.post('/job', async (req, res) => {
  const client = new FlashQ({ host: 'localhost' });
  await client.connect();
  await client.push('queue', req.body);
  await client.close();  // Connection churn!
});

// GOOD - Singleton client
const client = new FlashQ({ host: 'localhost' });
await client.connect();

app.post('/job', async (req, res) => {
  await client.push('queue', req.body);  // Reuses connection
});</code></pre>

      <h4>2. Network Timeouts</h4>
      <pre><code class="language-typescript">// Increase timeout for slow networks
const client = new FlashQ({
  host: 'remote-server.com',
  port: 6789,
  timeout: 30000  // 30 second timeout
});</code></pre>

      <h2>Problem: Memory Issues</h2>

      <p><strong>Symptoms:</strong></p>
      <ul>
        <li>Server memory growing continuously</li>
        <li>OOM kills</li>
        <li>Slow response times</li>
      </ul>

      <h3>Diagnosis</h3>

      <pre><code class="language-bash"># Check server memory
docker stats flashq-server

# Check completed jobs count
curl http://localhost:6790/stats | jq '.completed_jobs'</code></pre>

      <h3>Common Causes & Solutions</h3>

      <h4>1. Too Many Completed Jobs Stored</h4>
      <pre><code class="language-typescript">// Problem: Keeping too many completed job results
// Solution: Set retention limits

// Per-job retention
await client.push('my-queue', data, {
  keepCompletedAge: 3600000,  // Keep for 1 hour only
  keepCompletedCount: 100     // Or keep last 100
});

// Clean old jobs periodically
await client.clean('my-queue', 3600000, 'completed', 1000);
// Removes completed jobs older than 1 hour, max 1000</code></pre>

      <h2>Quick Reference: Debug Commands</h2>

      <table>
        <thead>
          <tr>
            <th>Problem</th>
            <th>Command</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td>Check server health</td>
            <td><code>curl localhost:6790/health</code></td>
          </tr>
          <tr>
            <td>View all queue stats</td>
            <td><code>curl localhost:6790/stats</code></td>
          </tr>
          <tr>
            <td>Check specific job</td>
            <td><code>client.getJob(jobId)</code></td>
          </tr>
          <tr>
            <td>View DLQ</td>
            <td><code>client.getDlq('queue', 100)</code></td>
          </tr>
          <tr>
            <td>Count jobs by state</td>
            <td><code>client.getJobCounts('queue')</code></td>
          </tr>
          <tr>
            <td>List stuck jobs</td>
            <td><code>client.getJobs('queue', 'active', 100)</code></td>
          </tr>
          <tr>
            <td>Check if paused</td>
            <td><code>client.isPaused('queue')</code></td>
          </tr>
          <tr>
            <td>Retry failed jobs</td>
            <td><code>client.retryDlq('queue')</code></td>
          </tr>
        </tbody>
      </table>

      <div class="callout callout-info">
        <strong>Still Stuck?</strong> Open an issue on <a href="https://github.com/egeominotti/flashq/issues" target="_blank">GitHub</a> with your diagnostic output and we'll help you troubleshoot.
      </div>

      <h2>Related Resources</h2>
      <ul>
        <li><a href="production-checklist.html">Production Checklist</a></li>
        <li><a href="error-handling-retry-patterns.html">Error Handling & Retry Patterns</a></li>
        <li><a href="monitoring-ai-pipelines.html">Monitoring AI Pipelines</a></li>
      </ul>

      <div class="article-cta">
        <h3>Need Help?</h3>
        <p>Check our documentation or open an issue on GitHub.</p>
        <a href="../docs/" class="btn btn-primary">Read the Docs ‚Üí</a>
      </div>
    </div>
  </article>

  <footer>
    <div class="container">
      <a href="../" class="logo"><span>‚ö°</span> flashQ</a>
      <div class="footer-links">
        <a href="https://github.com/egeominotti/flashq" target="_blank">GitHub</a>
        <a href="https://npmjs.com/package/flashq" target="_blank">npm</a>
        <a href="../docs/">Docs</a>
        <a href="../blog/">Blog</a>
      </div>
      <div class="footer-copy">¬© 2026 flashQ. MIT License.</div>
    </div>
  </footer>

  <script src="../script.js"></script>
  <script>hljs.highlightAll();</script>
</body>
</html>
