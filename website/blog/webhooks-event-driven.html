<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Webhooks and Event-Driven Architecture with flashQ - flashQ Blog</title>
  <meta name="description" content="Build event-driven systems with flashQ webhooks. Learn to handle Stripe, GitHub, and custom webhooks reliably with job queues, retries, and real-time notifications.">
  <meta name="keywords" content="webhooks, event-driven architecture, stripe webhooks, github webhooks, job queue webhooks, async processing, flashq events">
  <meta name="robots" content="index, follow">
  <meta name="author" content="flashQ Team">

  <meta property="og:title" content="Webhooks and Event-Driven Architecture with flashQ">
  <meta property="og:description" content="Build event-driven systems with flashQ webhooks.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://flashq.dev/blog/webhooks-event-driven.html">
  <meta property="og:image" content="https://flashq.dev/og-image.png">
  <meta property="og:site_name" content="flashQ">
  <meta property="article:published_time" content="2025-12-16">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Webhooks and Event-Driven Architecture with flashQ">
  <meta name="twitter:description" content="Build event-driven systems with flashQ webhooks.">
  <meta name="twitter:image" content="https://flashq.dev/og-image.png">

  <link rel="canonical" href="https://flashq.dev/blog/webhooks-event-driven.html">
  <link rel="alternate" type="application/rss+xml" title="flashQ Blog RSS Feed" href="https://flashq.dev/blog/feed.xml">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>‚ö°</text></svg>">

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="styles.css">

  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "TechArticle",
    "headline": "Webhooks and Event-Driven Architecture with flashQ",
    "description": "Build event-driven systems with flashQ webhooks.",
    "datePublished": "2025-12-16",
    "author": { "@type": "Organization", "name": "flashQ" }
  }
  </script>

  <!-- Breadcrumb Schema -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "BreadcrumbList",
    "itemListElement": [
      { "@type": "ListItem", "position": 1, "name": "Home", "item": "https://flashq.dev" },
      { "@type": "ListItem", "position": 2, "name": "Blog", "item": "https://flashq.dev/blog/" },
      { "@type": "ListItem", "position": 3, "name": "Webhooks & Event-Driven", "item": "https://flashq.dev/blog/webhooks-event-driven.html" }
    ]
  }
  </script>
  <!-- Highlight.js -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github-dark.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/typescript.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/bash.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/yaml.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
</head>
<body>
  <nav>
    <div class="container wide">
      <a href="../" class="logo"><span>‚ö°</span> flashQ</a>
      <div class="nav-links">
        <a href="../#features">Features</a>
        <a href="../blog/" class="active">Blog</a>
        <a href="../docs/">Docs</a>
        <a href="https://github.com/egeominotti/flashq" target="_blank">GitHub</a>
        <button class="search-trigger" onclick="openSearch()"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>Search <span class="kbd">‚åòK</span></button>
        <a href="../docs/#quickstart" class="btn btn-primary">Get Started</a>
      </div>
      <button class="mobile-menu-btn" aria-label="Menu"><span></span><span></span><span></span></button>
    </div>
  </nav>

  <div class="mobile-menu">
    <a href="../#features">Features</a><a href="../blog/">Blog</a><a href="../docs/">Docs</a>
    <a href="https://github.com/egeominotti/flashq" target="_blank">GitHub</a>
    <a href="../docs/#quickstart" class="btn btn-primary">Get Started</a>
  </div>

  <header class="article-header header-tutorial">
    <div class="container">
      <span class="article-tag tutorial">Tutorial</span>
      <h1>Webhooks and Event-Driven Architecture with flashQ</h1>
      <div class="article-meta">
        <span>üìÖ December 16, 2025</span>
        <span class="reading-time">‚è±Ô∏è 12 min read</span>
      </div>
    </div>
  </header>

  <article class="article-content">
    <div class="container wide">
      <div class="article-layout">
        <div class="article-main">

      <p>Webhooks are the backbone of modern integrations. When Stripe processes a payment, GitHub receives a push, or Shopify gets an order, they send webhooks to your application. The challenge? Handling them reliably at scale.</p>

      <p>flashQ transforms webhook handling from a fragile synchronous process into a robust, event-driven architecture.</p>

      <h2 id="problem">The Webhook Problem</h2>

      <p>Typical webhook issues:</p>

      <ul>
        <li><strong>Timeouts</strong>: Webhook providers expect fast responses (2-30 seconds)</li>
        <li><strong>Retries</strong>: Providers retry failed webhooks, causing duplicate processing</li>
        <li><strong>Order</strong>: Events can arrive out of order</li>
        <li><strong>Scale</strong>: Traffic spikes during peak times</li>
      </ul>

      <h2 id="solution">The flashQ Solution</h2>

      <pre><code class="language-plaintext">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   Webhook    ‚îÇ     ‚îÇ    flashQ    ‚îÇ     ‚îÇ   Worker     ‚îÇ
‚îÇ   Provider   ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ   (Enqueue)  ‚îÇ‚îÄ‚îÄ‚îÄ‚îÄ‚ñ∂‚îÇ  (Process)   ‚îÇ
‚îÇ              ‚îÇ     ‚îÇ   < 100ms    ‚îÇ     ‚îÇ   Async      ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
       ‚îÇ                    ‚îÇ
       ‚îÇ   Fast response    ‚îÇ   Reliable processing
       ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</code></pre>

      <h2 id="stripe">Handling Stripe Webhooks</h2>

      <pre><code class="language-typescript">// app/api/webhooks/stripe/route.ts
import { NextRequest, NextResponse } from 'next/server';
import Stripe from 'stripe';
import { Queue } from 'flashq';

const stripe = new Stripe(process.env.STRIPE_SECRET_KEY!);
const queue = new Queue('stripe-webhooks', { useHttp: true });

export async function POST(request: NextRequest) {
  const body = await request.text();
  const signature = request.headers.get('stripe-signature')!;

  // Verify webhook signature
  let event: Stripe.Event;
  try {
    event = stripe.webhooks.constructEvent(
      body,
      signature,
      process.env.STRIPE_WEBHOOK_SECRET!
    );
  } catch (err) {
    return NextResponse.json({ error: 'Invalid signature' }, { status: 400 });
  }

  // Enqueue for async processing (fast response to Stripe)
  await queue.add(event.type, event, {
    jobId: event.id,  // Idempotency - prevents duplicate processing
  });

  // Respond immediately (< 100ms)
  return NextResponse.json({ received: true });
}</code></pre>

      <h3>Stripe Worker</h3>

      <pre><code class="language-typescript">// workers/stripe.ts
import { Worker } from 'flashq';

new Worker('stripe-webhooks', async (job) => {
  const event = job.data;

  switch (event.type) {
    case 'checkout.session.completed':
      await handleCheckoutComplete(event.data.object);
      break;

    case 'invoice.paid':
      await handleInvoicePaid(event.data.object);
      break;

    case 'customer.subscription.deleted':
      await handleSubscriptionCanceled(event.data.object);
      break;

    default:
      console.log(`Unhandled event: ${event.type}`);
  }
}, {
  concurrency: 10,
});

async function handleCheckoutComplete(session) {
  // Create user account
  await db.users.create({
    email: session.customer_email,
    stripeCustomerId: session.customer,
  });

  // Send welcome email
  await emailQueue.add('welcome', {
    to: session.customer_email,
  });
}</code></pre>

      <h2 id="github">GitHub Webhooks</h2>

      <pre><code class="language-typescript">// app/api/webhooks/github/route.ts
import crypto from 'crypto';

export async function POST(request: NextRequest) {
  const body = await request.text();
  const signature = request.headers.get('x-hub-signature-256');
  const event = request.headers.get('x-github-event');
  const deliveryId = request.headers.get('x-github-delivery');

  // Verify signature
  const expected = `sha256=${crypto
    .createHmac('sha256', process.env.GITHUB_WEBHOOK_SECRET!)
    .update(body)
    .digest('hex')}`;

  if (signature !== expected) {
    return NextResponse.json({ error: 'Invalid signature' }, { status: 401 });
  }

  // Enqueue
  await queue.add(event!, JSON.parse(body), {
    jobId: deliveryId!,  // Idempotency
  });

  return NextResponse.json({ received: true });
}</code></pre>

      <h2 id="outgoing">Sending Outgoing Webhooks</h2>

      <p>flashQ can also send webhooks to your users:</p>

      <pre><code class="language-typescript">// Send webhook when job completes
worker.on('completed', async (job, result) => {
  if (job.data.webhookUrl) {
    await webhookQueue.add('send', {
      url: job.data.webhookUrl,
      event: 'job.completed',
      payload: { jobId: job.id, result },
    }, {
      attempts: 5,
      backoff: { type: 'exponential', delay: 1000 },
    });
  }
});

// Webhook sender worker
new Worker('outgoing-webhooks', async (job) => {
  const { url, event, payload } = job.data;

  const signature = crypto
    .createHmac('sha256', process.env.WEBHOOK_SECRET!)
    .update(JSON.stringify(payload))
    .digest('hex');

  const response = await fetch(url, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-Webhook-Signature': signature,
      'X-Webhook-Event': event,
    },
    body: JSON.stringify(payload),
  });

  if (!response.ok) {
    throw new Error(`Webhook failed: ${response.status}`);
  }
});</code></pre>

      <h2 id="patterns">Event-Driven Patterns</h2>

      <h3>Fan-Out Pattern</h3>

      <pre><code class="language-typescript">// One event triggers multiple actions
new Worker('events', async (job) => {
  if (job.name === 'user.created') {
    // Fan out to multiple queues
    await Promise.all([
      emailQueue.add('welcome', job.data),
      analyticsQueue.add('track', { event: 'signup', ...job.data }),
      slackQueue.add('notify', { message: `New user: ${job.data.email}` }),
    ]);
  }
});</code></pre>

      <h3>Saga Pattern</h3>

      <pre><code class="language-typescript">// Multi-step workflow with compensation
async function processOrder(orderId) {
  const steps = [];

  try {
    // Step 1: Reserve inventory
    steps.push(await inventoryQueue.add('reserve', { orderId }));
    await queue.finished(steps[0].id);

    // Step 2: Process payment
    steps.push(await paymentQueue.add('charge', { orderId }));
    await queue.finished(steps[1].id);

    // Step 3: Ship order
    steps.push(await shippingQueue.add('ship', { orderId }));
    await queue.finished(steps[2].id);

  } catch (error) {
    // Compensation: rollback in reverse order
    for (const step of steps.reverse()) {
      await queue.add('compensate', { stepId: step.id });
    }
  }
}</code></pre>

      <div class="callout callout-success">
        <div class="callout-title">üí° Pro Tip</div>
        <p>Always use webhook event IDs as job IDs for idempotency. This prevents duplicate processing when providers retry failed deliveries.</p>
      </div>

      <h2 id="conclusion">Conclusion</h2>

      <p>flashQ transforms webhook handling from a synchronous bottleneck into a scalable, event-driven architecture. Key benefits:</p>

      <ul>
        <li><strong>Fast responses</strong>: Acknowledge webhooks immediately</li>
        <li><strong>Reliability</strong>: Automatic retries with backoff</li>
        <li><strong>Idempotency</strong>: Prevent duplicate processing</li>
        <li><strong>Scalability</strong>: Handle traffic spikes gracefully</li>
      </ul>

      <div class="article-cta">
        <h3>Build Event-Driven Apps</h3>
        <p>Start handling webhooks reliably with flashQ.</p>
        <a href="../docs/#quickstart" class="btn btn-primary">Get Started ‚Üí</a>
      </div>
        </div>

        <aside class="toc-sidebar">
          <nav class="toc">
            <div class="toc-title">On this page</div>
            <ul class="toc-list">
              <li><a href="#problem">The Problem</a></li>
              <li><a href="#solution">The Solution</a></li>
              <li><a href="#stripe">Stripe Webhooks</a></li>
              <li><a href="#github">GitHub Webhooks</a></li>
              <li><a href="#outgoing">Outgoing Webhooks</a></li>
              <li><a href="#patterns">Event Patterns</a></li>
              <li><a href="#conclusion">Conclusion</a></li>
            </ul>
          </nav>
        </aside>
      </div>
    </div>
  </article>

  <footer>
    <div class="container wide">
      <a href="../" class="logo"><span>‚ö°</span> flashQ</a>
      <div class="footer-links">
        <a href="https://github.com/egeominotti/flashq" target="_blank">GitHub</a>
        <a href="https://npmjs.com/package/flashq" target="_blank">npm</a>
        <a href="../docs/">Docs</a>
        <a href="../blog/">Blog</a>
      </div>
      <div class="footer-copy">¬© <span id="year"></span> flashQ. MIT License.</div>
    </div>
  </footer>

  <div class="search-overlay" id="searchOverlay" onclick="closeSearch(event)">
    <div class="search-modal" onclick="event.stopPropagation()">
      <div class="search-input-wrapper">
        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"/></svg>
        <input type="text" class="search-modal-input" id="searchInput" placeholder="Search...">
        <span class="search-shortcut">ESC</span>
      </div>
      <div class="search-results" id="searchResults"></div>
    </div>
  </div>

  <script>
    document.getElementById("year").textContent = new Date().getFullYear();
    const mobileMenuBtn = document.querySelector(".mobile-menu-btn");
    const mobileMenu = document.querySelector(".mobile-menu");
    mobileMenuBtn.addEventListener("click", () => { mobileMenuBtn.classList.toggle("active"); mobileMenu.classList.toggle("active"); });
    const tocLinks = document.querySelectorAll('.toc-list a');
    const headings = document.querySelectorAll('h2[id]');
    function updateTocActive() { let current = ''; headings.forEach(h => { if (window.scrollY >= h.offsetTop - 120) current = h.id; }); tocLinks.forEach(l => l.classList.toggle('active', l.getAttribute('href') === '#' + current)); }
    window.addEventListener('scroll', updateTocActive); updateTocActive();
    function openSearch() { document.getElementById('searchOverlay').classList.add('active'); document.getElementById('searchInput').focus(); }
    function closeSearch(e) { if (e?.target === document.getElementById('searchOverlay')) document.getElementById('searchOverlay').classList.remove('active'); }
    document.addEventListener('keydown', e => { if ((e.metaKey||e.ctrlKey) && e.key==='k') { e.preventDefault(); openSearch(); } if (e.key==='Escape') closeSearch({target:document.getElementById('searchOverlay')}); });
  </script>
  <script>hljs.highlightAll();</script>
</body>
</html>
